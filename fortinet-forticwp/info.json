{
    "name": "fortinet-forticwp",
    "version": "1.0.0",
    "label": "Fortinet FortiCWP",
    "description": "FortiCWP Top Cloud Access Security Broker designed to provide visibility, compliance, data security, and threat protection for cloud-based services being used by an organization",
    "publisher": "Community",
    "icon_small_name": "small_icon.png",
    "icon_large_name": "large_icon.png",
    "cs_approved": true,
    "cs_compatible": true,
     "help_online": "",
    "category": "Investigation",
     "ingestion_modes": [
        "scheduled"
    ],
    "configuration": {
        "fields": [
            {
                "title": "Server URL",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "server_url",
                "description": "URL of the Fortinet FortiCWP API",
                "value": "https://www.forticwp.com"
            },
            {
                "title": "API Key",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "password",
                "name": "api_key",
                "description": "FortiCWP Credential, follow this link to generate it https://docs.fortinet.com/document/forticwp/21.1.0/online-help/585481/generate-credential "
            },
            {
                "title": "Verify SSL",
                "required": false,
                "editable": true,
                "visible": true,
                "type": "checkbox",
                "name": "verify_ssl",
                "value": true,
                "description": "Specifies whether the SSL certificate for the server is to be verified or not. By default, this option is set as True."
            }
        ]
    },
    "operations": [
        {
            "operation": "get_account_severity_level",
            "title": "Get Account Severity Level",
            "description": "Get severity level of each cloud service account",
            "category": "investigation",
            "annotation": "get_account_severity_level",
            "output_schema": "",
            "enabled": true,
            "parameters": []
        },
        {
            "operation": "get_account_role",
            "title": "Get User Account Details",
            "description": "Get user account details",
            "category": "investigation",
            "annotation": "get_account_role",
            "output_schema": "",
            "enabled": true,
            "parameters": []
        },
        {
            "operation": "get_alert_severities",
            "title": "Get Alert Severities",
            "description": "Get alert severities from FortiCWP",
            "category": "investigation",
            "annotation": "get_alert_severities",
            "output_schema": "",
            "enabled": true,
            "parameters": []
        },
        {
            "operation": "get_resource_map",
            "title": "Get Resource Map",
            "description": "Get the user and account basic information from FortiCWP",
            "category": "investigation",
            "annotation": "get_resource_map",
            "output_schema": "",
            "enabled": true,
            "parameters": []
        },
        {
            "operation": "get_alert_by_filter",
            "title": "Get Alerts",
            "description": "Get alerts of all accounts by filtering through alert filters",
            "category": "investigation",
            "annotation": "get_alert_by_filter",
            "output_schema": "",
            "enabled": true,
            "parameters": [
                {
                    "title": "Start Time",
                    "required": true,
                    "editable": true,
                    "visible": true,
                    "type": "datetime",
                    "name": "start_time",
                    "tooltip": "Time of the oldest data you want to get"
                },
                {
                    "title": "End Time",
                    "required": true,
                    "editable": true,
                    "visible": true,
                    "type": "datetime",
                    "name": "end_time",
                    "tooltip": "Time of the most recent data you want to get"
                },
                {
                    "title": "Records to Skip",
                    "required": false,
                    "editable": true,
                    "visible": true,
                    "type": "integer",
                    "name": "skip",
                    "tooltip": "Skip the first X records from results",
                    "value": 0
                },
                {
                    "title": "Limit Fetched Records To",
                    "required": false,
                    "editable": true,
                    "visible": true,
                    "type": "integer",
                    "name": "limit",
                    "tooltip": "Limit the number of returned records to X (Max is 1000)",
                    "value": 50
                },
                {
                    "title": "Alert IDs",
                    "required": false,
                    "editable": true,
                    "visible": true,
                    "type": "text",
                    "name": "alert_ids",
                    "placeholder": "c188ac17ab1a6c3d4665249ba6a40000, c111ac17ab1a6c3d4665249ba6a40dc6...",
                    "tooltip": "Fetch Alerts via their IDs (CSV if multiple alerts)"
                },
                {
                    "title": "User",
                    "required": false,
                    "editable": true,
                    "visible": true,
                    "type": "text",
                    "name": "alert_user",
                    "placeholder": "user1, user2, user3...",
                    "tooltip": "Filter alerts by one or multiple users (CSV if multiple users)"
                },
                {
                    "title": "Severity",
                    "required": false,
                    "editable": true,
                    "visible": true,
                    "type": "multiselect",
                    "name": "severity",
                    "options": ["Critical", "Alert", "Warning", "Information", "Pass"],
                    "tooltip": "Filter alerts by one or multiple Severities"
                },              
                {
                    "title": "State",
                    "required": false,
                    "editable": true,
                    "visible": true,
                    "type": "multiselect",
                    "name": "alert_state",
                    "options": ["Open", "Acknowledge", "Dismiss", "Resolved"],
                    "tooltip": "Filter alerts by one or multiple States"
                }
            ]
        }
    ]
    
}
